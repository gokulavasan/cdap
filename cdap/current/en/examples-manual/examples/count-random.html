<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta content="Cask Data, Inc." name="author" />
<meta content="Copyright © 2014 Cask Data, Inc." name="copyright" />
<script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-55081520-2']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
    </script>
    <title>Count Random &mdash; Cask Data Application Platform 2.5.2 Documentation</title>
    
    <link rel="stylesheet" href="../_static/cdap.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    



    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '2.5.2',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  false
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="top" title="Cask Data Application Platform 2.5.2 Documentation" href="../index.html" />
    <link rel="up" title="Examples" href="index.html" />
    <link rel="next" title="Purchase" href="purchase.html" />
    <link rel="prev" title="Word Count" href="word-count.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">Index</a></li>
        <li class="right" >
          <a href="purchase.html" title="Purchase"
             accesskey="N">Next</a> |</li>
        <li class="right" >
          <a href="word-count.html" title="Word Count"
             accesskey="P">Previous</a> |</li>
        <li><a href="../table-of-contents.html">CDAP Examples, Guides, and Tutorials</a> &raquo;</li>
          <li><a href="index.html" accesskey="U">Examples</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="count-random">
<span id="examples-count-random"></span><h1>Count Random<a class="headerlink" href="#count-random" title="Permalink to this headline">¶</a></h1>
<p>A Cask Data Application Platform (CDAP) Example demonstrating the <tt class="docutils literal"><span class="pre">&#64;Tick</span></tt> feature of Flows.</p>
<div class="section" id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>This application does not have a Stream, instead it uses a Tick annotation in the <tt class="docutils literal"><span class="pre">source</span></tt> flowlet to generate data:</p>
<ul class="simple">
<li>The <tt class="docutils literal"><span class="pre">generate</span></tt> method of the  <tt class="docutils literal"><span class="pre">source</span></tt> flowlet has a <tt class="docutils literal"><span class="pre">&#64;Tick</span></tt> annotation which specifies how frequently the method will be called.</li>
<li>The <tt class="docutils literal"><span class="pre">source</span></tt> flowlet generates a random integer in the range {1..10000} and emits it to the next flowlet <tt class="docutils literal"><span class="pre">splitter</span></tt>.</li>
<li>The <tt class="docutils literal"><span class="pre">splitter</span></tt> flowlet splits the number into digits, and emits these digits to the next stage.</li>
<li>The <tt class="docutils literal"><span class="pre">counter</span></tt> increments the count of the received number in the KeyValueTable.</li>
</ul>
<p>Let&#8217;s look at some of these elements, and then run the Application and see the results.</p>
<div class="section" id="the-count-random-application">
<h3>The Count Random Application<a class="headerlink" href="#the-count-random-application" title="Permalink to this headline">¶</a></h3>
<p>As in the other <a class="reference external" href="index.html">examples</a>, the components
of the Application are tied together by the class <tt class="docutils literal"><span class="pre">CountRandom</span></tt>:</p>
<div class="highlight-java"><div class="highlight"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">CountRandom</span> <span class="kd">extends</span> <span class="n">AbstractApplication</span> <span class="o">{</span>

  <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">TABLE_NAME</span> <span class="o">=</span> <span class="s">&quot;randomTable&quot;</span><span class="o">;</span>

  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">configure</span><span class="o">()</span> <span class="o">{</span>
    <span class="n">setName</span><span class="o">(</span><span class="s">&quot;CountRandom&quot;</span><span class="o">);</span>
    <span class="n">setDescription</span><span class="o">(</span><span class="s">&quot;Example random count application&quot;</span><span class="o">);</span>
    <span class="n">createDataset</span><span class="o">(</span><span class="n">TABLE_NAME</span><span class="o">,</span> <span class="n">KeyValueTable</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
    <span class="n">addFlow</span><span class="o">(</span><span class="k">new</span> <span class="n">CountRandomFlow</span><span class="o">());</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<p>The Flow contains three flowlets:</p>
<div class="highlight-java"><div class="highlight"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">CountRandomFlow</span> <span class="kd">implements</span> <span class="n">Flow</span> <span class="o">{</span>
  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="n">FlowSpecification</span> <span class="nf">configure</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="n">FlowSpecification</span><span class="o">.</span><span class="na">Builder</span><span class="o">.</span><span class="na">with</span><span class="o">()</span>
      <span class="o">.</span><span class="na">setName</span><span class="o">(</span><span class="s">&quot;CountRandom&quot;</span><span class="o">)</span>
      <span class="o">.</span><span class="na">setDescription</span><span class="o">(</span><span class="s">&quot;CountRandom Flow&quot;</span><span class="o">)</span>
      <span class="o">.</span><span class="na">withFlowlets</span><span class="o">()</span>
        <span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">&quot;source&quot;</span><span class="o">,</span> <span class="k">new</span> <span class="n">RandomSource</span><span class="o">())</span>
        <span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">&quot;splitter&quot;</span><span class="o">,</span> <span class="k">new</span> <span class="n">NumberSplitter</span><span class="o">())</span>
        <span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">&quot;counter&quot;</span><span class="o">,</span> <span class="k">new</span> <span class="n">NumberCounter</span><span class="o">())</span>
      <span class="o">.</span><span class="na">connect</span><span class="o">()</span>
        <span class="o">.</span><span class="na">from</span><span class="o">(</span><span class="s">&quot;source&quot;</span><span class="o">).</span><span class="na">to</span><span class="o">(</span><span class="s">&quot;splitter&quot;</span><span class="o">)</span>
        <span class="o">.</span><span class="na">from</span><span class="o">(</span><span class="s">&quot;splitter&quot;</span><span class="o">).</span><span class="na">to</span><span class="o">(</span><span class="s">&quot;counter&quot;</span><span class="o">)</span>
      <span class="o">.</span><span class="na">build</span><span class="o">();</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<p>The Flowlet (<em>source</em>) that generates random numbers every 1 millisecond:</p>
<div class="highlight-java"><div class="highlight"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">RandomSource</span> <span class="kd">extends</span> <span class="n">AbstractFlowlet</span> <span class="o">{</span>
  <span class="kd">private</span> <span class="n">OutputEmitter</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">randomOutput</span><span class="o">;</span>

  <span class="kd">private</span> <span class="kd">final</span> <span class="n">Random</span> <span class="n">random</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Random</span><span class="o">();</span>

  <span class="nd">@Tick</span><span class="o">(</span><span class="n">delay</span> <span class="o">=</span> <span class="mi">1L</span><span class="o">,</span> <span class="n">unit</span> <span class="o">=</span> <span class="n">TimeUnit</span><span class="o">.</span><span class="na">MILLISECONDS</span><span class="o">)</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">generate</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">InterruptedException</span> <span class="o">{</span>
    <span class="n">randomOutput</span><span class="o">.</span><span class="na">emit</span><span class="o">(</span><span class="n">random</span><span class="o">.</span><span class="na">nextInt</span><span class="o">(</span><span class="mi">10000</span><span class="o">));</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="building-and-starting">
<h2>Building and Starting<a class="headerlink" href="#building-and-starting" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>You can either build the example (as described <a class="reference external" href="#building-an-example-application">below</a>) or use the pre-built JAR file included in the CDAP SDK.</li>
<li>Start CDAP, deploy and start the application as described below in
<a class="reference internal" href="#running-cdap-applications">Running CDAP Applications</a>.
Make sure you start the flow and procedure as described.</li>
<li>Once the application has been deployed and started, you can <a class="reference external" href="#running-the-example">run the example.</a></li>
</ul>
</div>
<div class="section" id="running-cdap-applications">
<h2>Running CDAP Applications<a class="headerlink" href="#running-cdap-applications" title="Permalink to this headline">¶</a></h2>
<p>In the examples, we refer to the Standalone CDAP as &#8220;CDAP&#8221;, and the
example code that is running on it as an &#8220;Application&#8221;.</p>
<div class="section" id="building-an-example-application">
<h3>Building an Example Application<a class="headerlink" href="#building-an-example-application" title="Permalink to this headline">¶</a></h3>
<p>From the example&#8217;s project root, build an example with the
<a class="reference external" href="http://maven.apache.org">Apache Maven</a> command:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="gp">$</span> mvn clean package
</pre></div>
</div>
</div>
<div class="section" id="starting-cdap">
<h3>Starting CDAP<a class="headerlink" href="#starting-cdap" title="Permalink to this headline">¶</a></h3>
<p>Before running an Example Applications, check that an instance of CDAP is running and available; if not
follow the instructions for <a class="reference external" href="../source/../../developers-manual/getting-started/start-stop-cdap.html#start-stop-cdap" title="(in Cask Data Application Platform v2.5.2)"><em class="xref std std-ref">Starting and Stopping Standalone CDAP.</em></a></p>
<p>If you can reach the CDAP Console through a browser at <a class="reference external" href="http://localhost:9999/">http://localhost:9999/</a>, CDAP is running.</p>
</div>
<div class="section" id="deploying-an-application">
<h3>Deploying an Application<a class="headerlink" href="#deploying-an-application" title="Permalink to this headline">¶</a></h3>
<p>Once CDAP is started, you can deploy an example JAR by any of these methods:</p>
<ul>
<li><p class="first">Dragging and dropping the application JAR file (<tt class="docutils literal"><span class="pre">example/target/&lt;example&gt;-&lt;version&gt;.jar</span></tt>) onto the CDAP Console
running at <a class="reference external" href="http://localhost:9999/">http://localhost:9999/</a>; or</p>
</li>
<li><p class="first">Use the <em>Load App</em> button found on the <em>Overview</em> of the CDAP Console to browse and upload the Jar; or</p>
</li>
<li><p class="first">From the example&#8217;s project root run the App Manager script:</p>
<table border="1" class="docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><th class="stub">On Linux:</th>
<td><tt class="docutils literal"><span class="pre">$</span> <span class="pre">./bin/app-manager.sh</span> <span class="pre">--action</span> <span class="pre">deploy</span></tt></td>
</tr>
<tr class="row-even"><th class="stub">On Windows:</th>
<td><tt class="docutils literal"><span class="pre">&gt;</span> <span class="pre">bin\app-manager.bat</span> <span class="pre">deploy</span></tt></td>
</tr>
</tbody>
</table>
</li>
</ul>
</div>
<div class="section" id="starting-an-application">
<h3>Starting an Application<a class="headerlink" href="#starting-an-application" title="Permalink to this headline">¶</a></h3>
<p>Once an application is deployed:</p>
<ul>
<li><p class="first">You can go to the Application&#8217;s detail page in the CDAP Console by clicking on the
Application&#8217;s name in the <em>Overview</em> page. (It can be reached by clicking on the
<em>Application</em> button in the left sidebar of the window.) Now you can <em>Start</em> or <em>Stop</em> any
of the Processes or Queries associated with the application; or</p>
</li>
<li><p class="first">From the example&#8217;s project root run the App Manager script:</p>
<table border="1" class="docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><th class="stub">On Linux:</th>
<td><tt class="docutils literal"><span class="pre">$</span> <span class="pre">./bin/app-manager.sh</span> <span class="pre">--action</span> <span class="pre">start</span></tt></td>
</tr>
<tr class="row-even"><th class="stub">On Windows:</th>
<td><tt class="docutils literal"><span class="pre">&gt;</span> <span class="pre">bin\app-manager.bat</span> <span class="pre">start</span></tt></td>
</tr>
</tbody>
</table>
</li>
</ul>
</div>
<div class="section" id="stopping-an-application">
<h3>Stopping an Application<a class="headerlink" href="#stopping-an-application" title="Permalink to this headline">¶</a></h3>
<p>Once an application is deployed:</p>
<ul>
<li><p class="first">On the Application&#8217;s detail page in the CDAP Console, you can click the <em>Stop</em> button on
the Process and Query lists, if the application has either of them; or</p>
</li>
<li><p class="first">From the example&#8217;s project root run the App Manager script:</p>
<table border="1" class="docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><th class="stub">On Linux:</th>
<td><tt class="docutils literal"><span class="pre">$</span> <span class="pre">./bin/app-manager.sh</span> <span class="pre">--action</span> <span class="pre">stop</span></tt></td>
</tr>
<tr class="row-even"><th class="stub">On Windows:</th>
<td><tt class="docutils literal"><span class="pre">&gt;</span> <span class="pre">bin\app-manager.bat</span> <span class="pre">stop</span></tt></td>
</tr>
</tbody>
</table>
</li>
</ul>
</div>
</div>
<div class="section" id="running-the-example">
<h2>Running the Example<a class="headerlink" href="#running-the-example" title="Permalink to this headline">¶</a></h2>
<p>Once you start the flow, the <em>source</em> flowlet will continuously generate data. You can see this by observing the counters
for each flowlet in the flow visualization. Even though you are not injecting any data into the flow, the counters increase steadily.</p>
<div class="section" id="stopping-the-application">
<h3>Stopping the Application<a class="headerlink" href="#stopping-the-application" title="Permalink to this headline">¶</a></h3>
<p>Once done, you can stop the application as described above in <a class="reference external" href="#stopping-an-application">Stopping an Application.</a></p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div role="note" aria-label="manuals links">
    <h3>CDAP Documentation</h3>
    <ul class="this-page-menu">
      <li><a href="../table-of-contents/../../developers-manual/index.html"
            rel="nofollow">Developers’ Manual</a></li>
      <li><a href="../table-of-contents/../../reference-manual/index.html"
            rel="nofollow">Reference Manual</a></li>
      <li><a href="../table-of-contents/../../admin-manual/index.html"
            rel="nofollow">Administration Manual</a></li>
      <li><b><a href="../table-of-contents/../../examples-manual/index.html"
            rel="nofollow">Examples, Guides, and Tutorials</a></b></li>
      <li><a href="../table-of-contents/../../reference-manual/release-notes.html"
            rel="nofollow">Release Notes</a></li>
      <li><a href="../table-of-contents/../../reference-manual/glossary.html"
            rel="nofollow">Glossary</a></li>
      <li><a href="../table-of-contents/../../reference-manual/faq.html"
            rel="nofollow">FAQ</a></li>
    </ul>
   </div><!--
  Copyright © 2014 Cask Data, Inc.

  Licensed under the Apache License, Version 2.0 (the "License"); you may not
  use this file except in compliance with the License. You may obtain a copy of
  the License at

  http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
  WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the
  License for the specific language governing permissions and limitations under
  the License.
-->

<h3 class="pagenavtitle"><a href="../table-of-contents.html">Examples, Guides, and Tutorials: Table&nbsp;of&nbsp;Contents</a></h3>
<nav class="pagenav">
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../index.html">Introduction</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Examples</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="hello-world.html">Hello World</a></li>
<li class="toctree-l2"><a class="reference internal" href="word-count.html">Word Count</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="">Count Random</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="#building-and-starting">Building and Starting</a></li>
<li class="toctree-l3"><a class="reference internal" href="#running-cdap-applications">Running CDAP Applications</a></li>
<li class="toctree-l3"><a class="reference internal" href="#running-the-example">Running the Example</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="purchase.html">Purchase</a></li>
<li class="toctree-l2"><a class="reference internal" href="spark-k-means.html">Spark K-Means</a></li>
<li class="toctree-l2"><a class="reference internal" href="spark-page-rank.html">Spark Page Rank</a></li>
<li class="toctree-l2"><a class="reference internal" href="web-analytics.html">Web Analytics</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../how-to-guides/index.html">How-To Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../apps-packs.html">Apps and Packs</a></li>
</ul>

</nav>
  <h4>Previous Topic</h4>
  <p class="topless"><a href="word-count.html"
                        title="Previous Chapter">Word Count</a></p>
  <h4>Next Topic</h4>
  <p class="topless"><a href="purchase.html"
                        title="Next Chapter">Purchase</a></p>
  <div role="note" aria-label="downloads links">
    <h3>Downloads</h3>
    <ul class="this-page-menu">
      <li><a href="http://docs.cask.co/cdap/2.5.2/cdap-docs-2.5.2-web.zip"
            rel="nofollow">Zip Archive of CDAP Documentation</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick Search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer" role="contentinfo">

<style type="text/css">
.tg  {border-collapse:collapse;border-spacing:0;margin:0px auto;}
.tg td{padding:0px 20px 0px 20px;border-width:0px;overflow:hidden;word-break:normal;font-weight:normal;}
.tg th{padding:0px 20px 0px 20px;border-width:0px;overflow:hidden;word-break:normal;font-weight:normal;}
.tg .tg-s6z2{text-align:center;}
.tg .tg-0ord{text-align:right;}
.tg a{font-weight:bold;}
</style>
<table class="tg" width= 100%>
  <tr>
    <th class="tg-031e">Previous Topic: 
    <a title="Word Count" href="word-count.html" />Word Count</a>&nbsp;&nbsp;
    
    </th>
    <th class="tg-s6z2">
        &copy; Copyright 2014 Cask Data, Inc.
    
    </th>
    <th class="tg-0ord">&nbsp;&nbsp;Next Topic:
    <a title="Purchase" href="purchase.html" />Purchase</a>
    
    </th>
  </tr>
</table>

    </div>
  </body>
</html>